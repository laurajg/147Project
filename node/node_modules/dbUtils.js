module.exports = {
    
    initialize: function(callback) {
        var host = require('os').hostname();
        var MongoClient = require('mongodb').MongoClient, format = require('util').format;


        MongoClient.connect('mongodb://' + host + ':27017/goalglance', function(err, db) {
            if(err) return next(err);
            module.exports.db = db;
            callback();
        });
    },

    createUser: function(username, email, password) {

            var collection = module.exports.db.collection('users');
            collection.insert({'username': username,
                               'email': email,
                               'password': password}, function(err) {if(err) throw err;});
            this.checkUser(username, password);
            // needs to check if user exists and re-validate before adding
    },

    checkUser: function(username, password, successCB, failureCB) {
        // Locate all the entries using find
            var collection = module.exports.db.collection('users');
            collection.find({'username': username,
                              'password': password}).toArray(function(err, results) {
                                
                if (results.length) {
                    successCB();
                } else {
                    failureCB();
                }
            });
    },

    addPhoto: function() {}
}